from pyspark.sql import SparkSession
from pyspark.ml.evaluation import BinaryClassificationEvaluator

# Initialize Spark Session
spark = SparkSession.builder.appName('compute_auc').getOrCreate()

# Assume 'df' is your DataFrame and it has 'prediction' and 'ground_truth_label' columns

# Prepare your DataFrame
# Ensure that 'prediction' column contains raw prediction scores and 'ground_truth_label' contains true labels.

# Create an instance of BinaryClassificationEvaluator
evaluator = BinaryClassificationEvaluator(rawPredictionCol="prediction", labelCol="ground_truth_label", metricName="areaUnderROC")

# Compute AUC
auc = evaluator.evaluate(df)

# Print the AUC
print(f"The AUC is: {auc}")

# Optional: Stop the SparkSession
spark.stop()


